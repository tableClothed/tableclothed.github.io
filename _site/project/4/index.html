<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Blog &middot; portfolio - weronika zak
    
  </title>


<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic|Source+Code+Pro:400,700" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.min.css" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  <link rel="icon" type="image/png" sizes="192x192" href="/favicon.png">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/apple-touch-icon.png">
  
  <link rel="alternate" type="application/atom+xml" title="portfolio - weronika zak" href="/atom.xml">
</head>


  <body>
    <nav class="nav-main">
      <ul>
        <li class="hvr-underline-reveal"><a href="/pages/about/">about</a></li>
        <li class="logo"><a class="hvr-ripple-out" href="/">W</a></li>
        <li class="hvr-underline-reveal"><a href="/pages/blog/">blog</a></li>
      </ul>
    </nav>

    <div class="container content">
      <main>
        <!-- <div class="posts">
  
  <article class="post">
    <h1 class="post-title">
      <a href="/2021/7_Real_World_Data/">
        Real World Data
      </a>
    </h1>

    <time datetime="2021-04-22T16:10:35+01:00" class="post-date">22 Apr 2021</time>

    <h3 id="confusion-matrix">Confusion Matrix</h3>

<center>
<img src="/images/posts/Machine Learning/realdata/1.PNG" />
</center>

<h3 id="measuring-classifiers">Measuring Classifiers</h3>

<center>
<img src="/images/posts/Machine Learning/realdata/2.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/realdata/3.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/realdata/4.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/realdata/5.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/realdata/6.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/realdata/7.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/realdata/9.PNG" />
</center>

<h3 id="bias-and-variance">Bias and Variance</h3>

<p><strong>BIAS</strong> is how far removed the mean of your predicted values is from the “real” answer.</p>

<p><strong>VARIANCE</strong> is how scattered your predicted values are from the “real” answer.</p>

<center>
<img src="/images/posts/Machine Learning/realdata/10.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/realdata/11.PNG" />
</center>

<ol>
  <li>
    <p>low variance relative to these observations and high bias</p>
  </li>
  <li>
    <p>high variance, low bias</p>
  </li>
</ol>

<center>
<img src="/images/posts/Machine Learning/realdata/12.PNG" />
</center>

<p>Increasing K in <strong>K-Nearest-Neighbors</strong> decreases variance and increases bias (by averaging together more neighbors)</p>

<p>A single <strong>decision tree</strong> is prone to overfitting - high variance</p>
<ul>
  <li>but a random forest decreases that variance</li>
</ul>

<h3 id="k-fold-cross-validation">K-Fold Cross Validation</h3>

<ul>
  <li>split your data into K randomly-assigned segments</li>
  <li>reserve one segment as your test data</li>
  <li>train on the combined remaining K-1 segments and measure performance against the test set</li>
  <li>repeat for each segment</li>
  <li>take the average of the K-squared scores</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>

<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 

<span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s">"linear"</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

<span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.9666666666666667
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">scores</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([0.96666667, 1.        , 0.96666667, 0.96666667, 1.        ])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.9800000000000001
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s">"poly"</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

<span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.9
</code></pre></div></div>

<h3 id="dealing-with-outliers">Dealing with Outliers</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">incomes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">27000</span><span class="p">,</span> <span class="mi">15000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">incomes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">incomes</span><span class="p">,</span> <span class="p">[</span><span class="mi">1000000000</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">incomes</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/posts/Machine Learning/realdata/output_25_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">incomes</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>126959.41748252927
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">reject_outliers</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">filtered</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">u</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">filtered</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">filtered</span> <span class="o">=</span> <span class="n">reject_outliers</span><span class="p">(</span><span class="n">incomes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/posts/Machine Learning/realdata/output_28_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">filtered</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>26972.11342427752
</code></pre></div></div>

<center>
<img src="/images/posts/Machine Learning/realdata/12.PNG" />
</center>

<h3 id="data">Data</h3>

<center>
<img src="/images/posts/Machine Learning/realdata/13.PNG" />
</center>

<h4 id="oversampling">OVERSAMPLING</h4>
<p>Duplicate samples from the minrity class</p>

<p>Can be done at random</p>

<h4 id="undersampling">UNDERSAMPLING</h4>
<p>Instead of creating more positive samples, remove negative ones</p>

<p>Throwing data away is usually not the best approach</p>

<center>
<img src="/images/posts/Machine Learning/realdata/14.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/realdata/15.PNG" />
</center>

<h3 id="binning">Binning</h3>

<center>
<img src="/images/posts/Machine Learning/realdata/16.PNG" />
</center>

<h3 id="transforming">Transforming</h3>

<center>
<img src="/images/posts/Machine Learning/realdata/17.PNG" />
</center>

<h3 id="encoding">Encoding</h3>

<center>
<img src="/images/posts/Machine Learning/realdata/18.PNG" />
</center>

<h3 id="scaling--normalization">Scaling / Normalization</h3>

<center>
<img src="/images/posts/Machine Learning/realdata/19.PNG" />
</center>

  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/2021/3_Machine_Learning_w_Python2/">
        Machine Learning with Python, Part 2
      </a>
    </h1>

    <time datetime="2021-04-22T16:10:35+01:00" class="post-date">22 Apr 2021</time>

    <h3 id="decision-tree">Decision Tree</h3>

<p><img src="/images/posts/Machine Learning/mlpython2/1.PNG" alt="image.PNG" /></p>

<p><img src="/images/posts/Machine Learning/mlpython2/2.PNG" alt="image.PNG" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">no</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"data/PastHires.csv"</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Years Experience</th>
      <th>Employed?</th>
      <th>Previous employers</th>
      <th>Level of Education</th>
      <th>Top-tier school</th>
      <th>Interned</th>
      <th>Hired</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>Y</td>
      <td>4</td>
      <td>BS</td>
      <td>N</td>
      <td>N</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>N</td>
      <td>0</td>
      <td>BS</td>
      <td>Y</td>
      <td>Y</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>N</td>
      <td>6</td>
      <td>BS</td>
      <td>N</td>
      <td>N</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>Y</td>
      <td>1</td>
      <td>MS</td>
      <td>Y</td>
      <td>N</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
      <td>N</td>
      <td>2</td>
      <td>PhD</td>
      <td>Y</td>
      <td>N</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">"Y"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">"N"</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
<span class="n">df</span><span class="p">[</span><span class="s">"Hired"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"Hired"</span><span class="p">]</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">"Hired"</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0     1
1     1
2     0
3     1
4     0
5     1
6     1
7     1
8     1
9     0
10    0
11    1
12    1
Name: Hired, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"Employed?"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"Employed?"</span><span class="p">]</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">"Top-tier school"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"Top-tier school"</span><span class="p">]</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">"Interned"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"Interned"</span><span class="p">]</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">"BS"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">"MS"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">"PhD"</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="n">df</span><span class="p">[</span><span class="s">"Level of Education"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"Level of Education"</span><span class="p">]</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Years Experience</th>
      <th>Employed?</th>
      <th>Previous employers</th>
      <th>Level of Education</th>
      <th>Top-tier school</th>
      <th>Interned</th>
      <th>Hired</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">6</span><span class="p">])</span>
<span class="n">features</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['Years Experience',
 'Employed?',
 'Previous employers',
 'Level of Education',
 'Top-tier school',
 'Interned']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"Hired"</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">sklearn.externals.six</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">import</span> <span class="nn">pydotplus</span> <span class="k">as</span> <span class="n">pydot</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># !pip install pydotplus
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># dot_data = StringIO()
# tree.export_graphviz(clf, out_file=dot_data, feature_names=features)
# graph = pydot.graph_from_dot_data(dot_data.getvalue())
# Image(graph.create_png())
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([1], dtype=int64)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([0], dtype=int64)
</code></pre></div></div>

<h3 id="ensemble-learning">Ensemble Learning</h3>

<p>Random Forests was an example of ensemble learning.</p>

<p>It just means we use models to try and solve the same roblem, and let them vote on the results.</p>

<p><img src="/images/posts/Machine Learning/mlpython2/3.PNG" alt="image.PNG" /></p>

<p><img src="/images/posts/Machine Learning/mlpython2/4.PNG" alt="image.PNG" /></p>

<h3 id="cgboost">CGBoost</h3>

<p>eXtreme Gradient Boosted Trees</p>

<p>Remember, boosting is an ensemble method
    - each tree boosts attributes that let to misclassifications of previous tree</p>

<p>More facts:
    - routinely winds Kaggle competitions
    - easy to use and fast</p>

<p><img src="/images/posts/Machine Learning/mlpython2/5.PNG" alt="image.PNG" /></p>

<p><img src="/images/posts/Machine Learning/mlpython2/6.PNG" alt="image.PNG" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>

<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>

<span class="n">numSamples</span><span class="p">,</span> <span class="n">numFeatures</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">numSamples</span><span class="p">,</span> <span class="n">numFeatures</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(150, 4)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris</span><span class="o">.</span><span class="n">target_names</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array(['setosa', 'versicolor', 'virginica'], dtype='&lt;U10')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># with random_state=0, the accuracy_score is equal 1.0
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="n">xgb</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">DMatrix</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">Y_train</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">DMatrix</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">Y_test</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"max_depth"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
    <span class="s">"eta"</span><span class="p">:</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="s">"objective"</span><span class="p">:</span><span class="s">"multi:softmax"</span><span class="p">,</span>
    <span class="s">"num_class"</span><span class="p">:</span><span class="mi">3</span>
<span class="p">}</span>

<span class="n">epochs</span><span class="o">=</span><span class="mi">10</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">epochs</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">predictions</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([0., 1., 1., 0., 2., 1., 2., 0., 0., 2., 1., 0., 2., 1., 1., 0., 1.,
       1., 0., 0., 1., 1., 2., 0., 2., 1., 0., 0., 1., 2.], dtype=float32)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">accuracy_score</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.9666666666666667
</code></pre></div></div>

<h3 id="support-vector-machines">Support Vector Machines</h3>

<p><img src="/images/posts/Machine Learning/mlpython2/6.PNG" alt="image.PNG" /></p>

<p>The important point is that SVM’s employ some advanced mathematical trickery to cluster data, and it can handle datasets with lots of features.</p>

<p>It’s also fairly expensive - the “kernel trick” is the only thing that makes it possible.</p>

<p><img src="/images/posts/Machine Learning/mlpython2/7.PNG" alt="image.PNG" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">createClusteredData</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
    <span class="n">pointsPerCluster</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">k</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">incomeCentroid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">2000.</span><span class="p">,</span> <span class="mf">200000.</span><span class="p">)</span>
        <span class="n">ageCentroid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">70.</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pointsPerCluster</span><span class="p">)):</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">incomeCentroid</span><span class="p">,</span> <span class="mf">10000.</span><span class="p">),</span> 
                      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">ageCentroid</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)])</span>
            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">createClusteredData</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">float</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/posts/Machine Learning/mlpython2/output_39_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scaling</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaling</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">float</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/posts/Machine Learning/mlpython2/output_40_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span><span class="p">,</span> <span class="n">datasets</span>

<span class="n">C</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">svc</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s">"linear"</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plotPredictions</span><span class="p">(</span><span class="n">clf</span><span class="p">):</span>
    <span class="c1"># create a dense grid of points to sample
</span>    <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">.001</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">.001</span><span class="p">))</span>
    <span class="c1"># convert to Numpy arrays
</span>    <span class="n">npx</span> <span class="o">=</span> <span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">npy</span> <span class="o">=</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    
    <span class="c1"># convert to aa list of 2D (income, age) points
</span>    <span class="n">samplePoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">npx</span><span class="p">,</span> <span class="n">npy</span><span class="p">]</span>
    
    <span class="c1"># Generte predicted labels (cluster numbers) for each point
</span>    <span class="n">Z</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">samplePoints</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># reshape results to match xx dimension
</span>    <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Paired</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span> <span class="c1"># draw the contour
</span>    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">float</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plotPredictions</span><span class="p">(</span><span class="n">svc</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/images/posts/Machine Learning/mlpython2/output_43_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">scaling</span><span class="o">.</span><span class="n">transform</span><span class="p">([[</span><span class="mi">20000</span><span class="p">,</span> <span class="mi">40</span><span class="p">]]))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([2])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">scaling</span><span class="o">.</span><span class="n">transform</span><span class="p">([[</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">65</span><span class="p">]]))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([1])
</code></pre></div></div>


  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/2021/3_Machine_Learning_w_Python/">
        Machine Learning with Python, Part 1
      </a>
    </h1>

    <time datetime="2021-04-21T16:10:35+01:00" class="post-date">21 Apr 2021</time>

    <h3 id="train--test-split">Train / Test split</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pageSpeed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">purchaseAmount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pageSpeed</span><span class="p">,</span> <span class="n">purchaseAmount</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/posts/Machine Learning/mlpython/output_2_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">trainX</span> <span class="o">=</span> <span class="n">pageSpeed</span><span class="p">[:</span><span class="mi">80</span><span class="p">]</span>
<span class="n">testX</span> <span class="o">=</span> <span class="n">pageSpeed</span><span class="p">[</span><span class="mi">80</span><span class="p">:]</span>

<span class="n">trainy</span> <span class="o">=</span> <span class="n">purchaseAmount</span><span class="p">[:</span><span class="mi">80</span><span class="p">]</span>
<span class="n">testy</span> <span class="o">=</span> <span class="n">purchaseAmount</span><span class="p">[</span><span class="mi">80</span><span class="p">:]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">trainX</span><span class="p">,</span> <span class="n">trainy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/posts/Machine Learning/mlpython/output_4_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">trainX</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">trainy</span><span class="p">)</span>

<span class="n">p4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">p4</span><span class="p">(</span><span class="n">xp</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s">"r"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/posts/Machine Learning/mlpython/output_6_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">testx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">testX</span><span class="p">)</span>
<span class="n">testy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">testy</span><span class="p">)</span>

<span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">testx</span><span class="p">,</span> <span class="n">testy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">p4</span><span class="p">(</span><span class="n">xp</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s">"r"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/posts/Machine Learning/mlpython/output_7_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">testy</span><span class="p">,</span> <span class="n">p4</span><span class="p">(</span><span class="n">testx</span><span class="p">))</span>
<span class="n">r2</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-0.12120962193840445
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">trainy</span><span class="p">),</span> <span class="n">p4</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">trainX</span><span class="p">)))</span>
<span class="n">r2</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.055981669130389156
</code></pre></div></div>

<h3 id="bayesian-methods">Bayesian Methods</h3>

<p><img src="/images/posts/Machine Learning/mlpython/1.png" alt="image.png" /></p>

<p><img src="/images/posts/Machine Learning/mlpython/2.png" alt="image.png" /></p>

<h3 id="naive-bayes">Naive Bayes</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">readFiles</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            
            <span class="n">inBody</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"latin1"</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">inBody</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">:</span>
                    <span class="n">inBody</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">message</span>

<span class="k">def</span> <span class="nf">dfFromDirectory</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">classification</span><span class="p">):</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">readFiles</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">"message"</span><span class="p">:</span><span class="n">message</span><span class="p">,</span> <span class="s">"class"</span><span class="p">:</span><span class="n">classification</span><span class="p">})</span>
    
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">"message"</span><span class="p">:[],</span> <span class="s">"class"</span><span class="p">:[]})</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dfFromDirectory</span><span class="p">(</span><span class="s">"emails/spam"</span><span class="p">,</span> <span class="s">"spam"</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dfFromDirectory</span><span class="p">(</span><span class="s">"emails/ham"</span><span class="p">,</span> <span class="s">"ham"</span><span class="p">))</span>
<span class="n">df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>message</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Tr...</td>
      <td>spam</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1) Fight The Risk of Cancer!\n\nhttp://www.adc...</td>
      <td>spam</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1) Fight The Risk of Cancer!\n\nhttp://www.adc...</td>
      <td>spam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>##############################################...</td>
      <td>spam</td>
    </tr>
    <tr>
      <th>4</th>
      <td>I thought you might like these:\n\n1) Slim Dow...</td>
      <td>spam</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2495</th>
      <td>Man killed 'trying to surf' on Tube train \n\n...</td>
      <td>ham</td>
    </tr>
    <tr>
      <th>2496</th>
      <td>Hi Gianni,\n\n\n\nA very good resource for thi...</td>
      <td>ham</td>
    </tr>
    <tr>
      <th>2497</th>
      <td>Gianni Ponzi wrote:\n\n&gt; I have a prob when tr...</td>
      <td>ham</td>
    </tr>
    <tr>
      <th>2498</th>
      <td>Neale Pickett &lt;neale@woozle.org&gt; writes:\n\n\n...</td>
      <td>ham</td>
    </tr>
    <tr>
      <th>2499</th>
      <td>\n\nHi,\n\n\n\nI think you need to give us a l...</td>
      <td>ham</td>
    </tr>
  </tbody>
</table>
<p>3000 rows × 2 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">()</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">"message"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">classifier</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">()</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"class"</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MultinomialNB(alpha=1.0, class_prior=None, fit_prior=True)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">examples</span> <span class="o">=</span> <span class="p">[</span><span class="s">"DISCOUNT ON THE NEWEST GUCCI FASHION"</span><span class="p">,</span> <span class="s">"Hi, wassup, are yu free tomorrow?"</span><span class="p">]</span>
<span class="n">example_counts</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">examples</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">example_counts</span><span class="p">)</span>
<span class="n">predictions</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array(['spam', 'ham'], dtype='&lt;U4')
</code></pre></div></div>

<h3 id="k-means-clustering">K-Means Clustering</h3>

<p><img src="/images/posts/Machine Learning/mlpython/3.PNG" alt="image.png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">createClusteredData</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
    <span class="n">pointsPerCluster</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">k</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">incomeCentroid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">2000.</span><span class="p">,</span> <span class="mf">200000.</span><span class="p">)</span>
        <span class="n">ageCentroid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">70.</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pointsPerCluster</span><span class="p">)):</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">incomeCentroid</span><span class="p">,</span> <span class="mf">10000.</span><span class="p">),</span> 
                      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">ageCentroid</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)])</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">scale</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">createClusteredData</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="o">.</span><span class="n">labels_</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([4, 4, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 4, 4, 4, 4, 4, 4, 3, 3,
       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 4, 1, 1, 1,
       1, 1, 1, 1, 4, 1, 1, 1, 1, 1, 1, 1])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">labels_</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">float</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/posts/Machine Learning/mlpython/output_25_0.png" alt="png" /></p>

<h3 id="entropy">Entropy</h3>

<p><img src="/images/posts/Machine Learning/mlpython/4.PNG" alt="image.png" /></p>

<p><img src="/images/posts/Machine Learning/mlpython/5.PNG" alt="image.png" /></p>

  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/2021/Notes/">
        Machine Learning General Questions
      </a>
    </h1>

    <time datetime="2021-03-21T15:10:35+00:00" class="post-date">21 Mar 2021</time>

    <h1 id="machine-learning-questions">MACHINE LEARNING QUESTIONS</h1>

<center>
<img src="/images/posts/Machine Learning/mlnotes/ml.png" style="max-width: 500px" />
</center>

<h3 id="1-what-are-the-different-types-of-machine-learning">1. What are the different types of Machine Learning?</h3>
<ol>
  <li>Supervised Learning
    <ul>
      <li>machine lears using labeled data</li>
      <li>it’s like learning under the guidace of a teacher</li>
      <li>model is trained on pre-defined dataset before it starts making decision when given new data</li>
    </ul>
  </li>
</ol>

<p><br /></p>

<ol>
  <li>Unsupervised Learning
    <ul>
      <li>the machine is trained on unlabelled data, without any guidance</li>
      <li>learning without a teacher</li>
      <li>models learn through observation and finds structures in data</li>
      <li>model is given a dataset and then left to automatically find patterns and relationships by creating clusters</li>
    </ul>
  </li>
</ol>

<p><br /></p>

<ol>
  <li>Reinforcement Learning
    <ul>
      <li>involves an agent that interacts with its environment by producing actions &amp; discovers errors or rewards’- it’s like being stuck in an isolated island where you must explore the environment and learn how to live and adapt to the living conditions on your own</li>
      <li>model learns through hit and trial method</li>
      <li>learns on the basis of reward or penalty given for every action it performs</li>
    </ul>
  </li>
</ol>

<h3 id="2-how-would-you-explain-machine-learning-to-a-school-going-kid">2. How would you explain Machine Learning to a school-going kid?</h3>
<ul>
  <li>Suppose your friend invites you to his party where you meet total strangers.
Since you have no idea about them, you will mentally classify them on the basis of gender, age, group, dressing, etc.</li>
  <li>in this scenari the strangers represent the unlabelled data and the process od classifying unlabelled data point (unsupervised learning)</li>
  <li>since you didn’t use any prior knowledge abut people and classified them on-the-go, this becomes an unsupervised learning problem.</li>
</ul>

<h3 id="3--how-does-deep-learning-differ-from-machine-learning">3.  How does Deep Learning differ from Machine Learning?</h3>
<ul>
  <li>
    <p>DEEP LEARNING - form of ML that is inspired by the structure of the human brain and is particulary effective in feature detection.</p>
  </li>
  <li>
    <p>MACHINE LEARNING - algorithms that parse data, learn from data, and then apply what they’ve learnt to make informed decisions.</p>
  </li>
</ul>

<h3 id="4-explain-classification-and-regression">4. Explain Classification and Regression</h3>
<ol>
  <li>Classification:
    <ul>
      <li>predicting a discrete class label</li>
      <li>data is labelled into one of two or more class</li>
      <li>two classes -&gt; binary, more -&gt; multi-class classification</li>
      <li>examples: classifying email as SPAM or non-SPAM</li>
    </ul>
  </li>
</ol>

<p><br /></p>

<ol>
  <li>Regression:
    <ul>
      <li>predicting a continous quantity</li>
      <li>requires the prediction of a quantity</li>
      <li>if it has multiple input variables it’s called a multivariate regression</li>
      <li>examples: predicting the price of a stock over a period of time</li>
    </ul>
  </li>
</ol>

<h3 id="5-what-do-you-understand-by-selection-bias">5. What do you understand by selection bias?</h3>
<ul>
  <li>statistical error that causes a bias in the sampling portion of an experiment</li>
  <li>the error causes one sampling group to be selected more often than other groups included in the experiment</li>
  <li>
    <p>selection bias may produce an inaccurate conclusion if the selection bias is not identified</p>
  </li>
  <li>błąd statystyczny, który powoduje odchylenie w próbkowaniu części eksperymentu</li>
  <li>błąd powoduje, że jedna grupa losowania jest wybierana częściej niż inne grupy objęte eksperymentem</li>
  <li>błąd selekcji może prowadzić do niedokładnych wniosków, jeśli błąd selekcji nie zostanie zidentyfikowany</li>
</ul>

<h3 id="6-what-do-you-understand-by-precision-and-recall">6. What do you understand by Precision and Recall?</h3>
<p>Let me explain you this with an analogy:</p>

<p>Imagine that, your girlfriend gave you a birthday surprise every year for the last 10 years. One day, your girlfriend asks you: ‘Sweetie, do you remember all the birthday surprises from me?’
To stay on good terms with your girlfriend, you need to recall all the 10 events from your memory. Therefore, recall is the ratio of the number of events you can correctly recall, to the total number of events.</p>

<p>If you can recall all 10 events correctly, then, your recall ratio is 1.0 (100%) and if you can recall 7 events correctly, your recall ratio is 0.7 (70%).</p>

<p><br /><br /></p>

<p>However, you might be wrong in some answers.</p>

<p>For example, let’s assume that you took 15 guesses out of which 10 were correct and 5 were wrong. This means that you can recall all events but not so precisely.</p>

<p>Therefore, precision is the ratio of a number of events you can correctly recall, to the total number of events you can recall (mix of correct and wrong recalls).</p>

<p><br /><br /></p>

<p>From the above example (10 real events, 15 answers: 10 correct, 5 wrong), you get 100% recall but your precision is only 66.67% (10 / 15)</p>

<h3 id="7-explain-false-negative-false-positive-true-negative-and-true-positive-with-a-simple-example">7. Explain false negative, false positive, true negative and true positive with a simple example.</h3>
<p>Scenario of a fire emergency:</p>

<ul>
  <li><strong>True Positive</strong>: If the alarm goes on in case of a fire.</li>
</ul>

<p><em>FIRE IS POSITIVE AND PREDICTION MADE BY THE SYSTEM IS TRUE</em></p>

<p><br /></p>

<ul>
  <li><strong>False Positive</strong>: if the alarm goes on and there is no fire.</li>
</ul>

<p><em>SYSTEM PREDICTED FIRE TO BE POSITIVE WHICH IS A WRONG PREDICTION HENCE THE PREDICTION IS FALSE</em></p>

<p><br /></p>

<ul>
  <li><strong>False Negative</strong>: If the alarm does not ring but there was a fire.</li>
</ul>

<p><em>SYSTEM PREDICTED FIRE TO BE NEGATIVE WHICH WAS FALSE SINCE THERE WAS FIRE.</em></p>

<p><br /></p>

<ul>
  <li><strong>True Negative</strong>: If the alarm does not ring and there was no fire</li>
</ul>

<p><em>THE FIRE IS NEGATIVE AND THIS PREDICTION WAS TRUE</em></p>

<h3 id="8-what-is-a-confusion-matrix">8. What is a Confusion Matrix?</h3>

<h3 id="9-what-is-the-difference-between-inductive-and-deductive-learning">9. What is the difference between inductive and deductive learning?</h3>

<ul>
  <li>
    <p><strong>Inductive learning</strong> is the process of using observations to draw conclusions</p>
  </li>
  <li>
    <p><strong>Deductive learning</strong> is the process of using conclusions to form observations</p>
  </li>
</ul>

<center>
<img src="/images/posts/Machine Learning/mlnotes/1.PNG" />
</center>

<h3 id="10-how-is-knn-different-from-k-means-clustering">10. How is KNN different from K-means clustering?</h3>
<ol>
  <li><strong>K-Nearest Neighbour</strong>
    <ul>
      <li>Supervised Technique</li>
      <li>Used for Classification or Regression</li>
      <li>“K” in KNN represents the number of nearest neighbours used to classify or predict in case of continous variable/regression</li>
    </ul>
  </li>
</ol>

<p><br /></p>

<ol>
  <li><strong>K-Means Clustering</strong>
    <ul>
      <li>Unsupervised Technique</li>
      <li>Used for Clustering</li>
      <li>“K” in K Means represent the number of clusters the algorithm is trying to identify or learn from the data</li>
    </ul>

    <center>
 <img src="/images/posts/Machine Learning/mlnotes/2.PNG" />
 </center>
  </li>
</ol>

<h3 id="11-what-is-roc-curve-and-what-does-it-represent">11. What is ROC curve and what does it represent?</h3>
<p><strong>Receiver Operating Characteristic</strong> curve is a fundamental tool for diagnostic test evaluation and is a plot of the true positive rate (Sensivity) against the false positive rate (Specifity) for the different possible cut-off points of a diagnostic test.</p>

<p><br /></p>

<center>
<img src="/images/posts/Machine Learning/mlnotes/3.PNG" />
</center>

<p><br /></p>

<ul>
  <li>it shows the trade-off between sensitivity and specifity (any increase in sensitivity will be accompanied by a decrease in specifity)</li>
  <li>the closer the curve follows the left-hand border and then the top border of the ROC space</li>
</ul>

  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/2021/9_Experimental_Design_ML/">
        Experimental Design
      </a>
    </h1>

    <time datetime="2021-02-21T15:10:35+00:00" class="post-date">21 Feb 2021</time>

    <h3 id="ab-testing">A/B Testing</h3>

<ul>
  <li>A controlled experiment, usually in the context of a website</li>
  <li>You test the performance of some change to your website (the variant) and measure conversion relative to your unchanged site (the control).</li>
</ul>

<center>
<img src="/images/posts/Machine Learning/ab/1.PNG" />
</center>

<p>Ideally choose what you are trying to influence:</p>
<ul>
  <li>oder amount</li>
  <li>profit</li>
  <li>ad clicks</li>
  <li>order quantity</li>
</ul>

<p>But attributing actions downstream from your change can be hard</p>
<ul>
  <li>Especially if you;re running more than one experiment</li>
</ul>

<p><strong>VARIANCE IS THE ENEMY</strong>
Common mistake:</p>
<ul>
  <li>Run a test for some small period of time that results in a few purchases to analyze</li>
  <li>You take the mean order amount from a and B, and declare victory or defeat</li>
  <li>But there’s so much random variation in order amounts to begin with, tha your results was just based on chance</li>
  <li>You then fool yourself into thinking some change to your website, which could actually be harmful, has made tons of money</li>
  <li>Sometimes you need to also look at conversion metrics with less variance</li>
  <li>Order quantities vs order dollar amounts, for example</li>
</ul>

<h3 id="t-tests-and-p-values">T-Tests and P-Values</h3>

<p>So, how do we know if a result is likely to be “real” as opposed to just random variation?</p>

<p>T-Test and P-Values!</p>

<h4 id="the-t-statistic">The T-Statistic</h4>

<ul>
  <li>A measure of the difference between the two sets expressed in units of standard error</li>
  <li>The size of the difference relative to the variance in the data</li>
  <li>A high T value means there’s probably a real difference between the two sets</li>
  <li>Assumes a normal distribution of behavior
    <ul>
      <li>This is a good assumption of you’re measuring revenue as conversion</li>
      <li>Fisher’s exact test (clickthrough rates), E-test (for transactions per user), and chi-squared test (for product quantities purchased)</li>
    </ul>
  </li>
  <li>miara różnicy między dwoma zestawami wyrażona w jednostkach błędu standardowego</li>
  <li>wielkość różnicy w stosunku do wariancji danych</li>
  <li>Wysoka wartość T oznacza, że prawdopodobnie istnieje prawdziwa różnica między dwoma zestawami</li>
  <li>Zakłada normalny rozkład zachowania
    <ul>
      <li>To dobre założenie, że mierzysz przychody jako konwersje</li>
      <li>Dokładny test Fishera (współczynniki klikalności), E-test (dla transakcji na użytkownika) i test chi-kwadrat (dla ilości zakupionych produktów)</li>
    </ul>
  </li>
</ul>

<h4 id="the-p-value">The P-Value</h4>
<ul>
  <li>Think of it as the probability of A and B satisfying the “null hypothesis” (that there is no real difference between the control and treatment’s behaviour)</li>
  <li><strong>So, a low P-Value implies significance.</strong></li>
  <li>
    <p>It is the probability of an observer lying at an extreme t-value assuming the null hypothesis.</p>
  </li>
  <li>Potraktuj to jako prawdopodobieństwo spełnienia przez A i B „hipotezy zerowej”</li>
  <li>Tak więc niska wartość P oznacza znaczenie.</li>
  <li>Jest to prawdopodobieństwo, że obserwator leży na skrajnej wartości t przy założeniu hipotezy zerowej.</li>
</ul>

<center>
<img src="/images/posts/Machine Learning/ab/2.PNG" />
</center>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">25.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">26.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ttest_indResult(statistic=-14.20191652286491, pvalue=1.4847065535663492e-45)
</code></pre></div></div>

<p>The t-statistic is a measure of the difference between the two sets expressed in units of standard error. Put differently, it’s the size of the difference relative to the variance in the data. A high t value means there’s probably a real difference between the two sets; you have “significance”. The P-value is a measure of the probability of an observation lying at extreme t-values; so a low p-value also implies “significance.” If you’re looking for a “statistically significant” result, you want to see a very low p-value and a high t-statistic (well, a high absolute value of the t-statistic more precisely). In the real world, statisticians seem to put more weight on the p-value result.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">25.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>

<span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ttest_indResult(statistic=-0.07828796143840591, pvalue=0.9375997767163184)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">25.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">25.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>

<span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ttest_indResult(statistic=0.5752102121870725, pvalue=0.5651497840962222)
</code></pre></div></div>

<p>Our p-value actually got a little lower, and the t-test a little larger, but still not enough to declare a real difference. So, you could have reached the right decision with just 10,000 samples instead of 100,000. Even a million samples doesn’t help, so if we were to keep running this A/B test for years, you’d never acheive the result you’re hoping for:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">25.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">25.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">)</span>

<span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ttest_indResult(statistic=0.16312002647674892, pvalue=0.8704239486112085)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ttest_indResult(statistic=0.0, pvalue=1.0)
</code></pre></div></div>

<h4 id="how-do-i-know-when-im-done-with-ab-test">How do I know when I’m done with A/B test?</h4>
<ul>
  <li>You have achieved significance (positive or negative)</li>
  <li>You no longer observe meaningful trends in your p-value
    <ul>
      <li>That is, you don’t see any indication that your experiment will “converge” on a result over time</li>
    </ul>
  </li>
  <li>You reach some pre-established upper bound on time</li>
</ul>

<center>
<img src="/images/posts/Machine Learning/ab/3.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/ab/4.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/ab/5.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/ab/6.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/ab/7.PNG" />
</center>

<center>
<img src="/images/posts/Machine Learning/ab/8.PNG" />
</center>

  </article>
  
</div> -->





<div class="pagination">
  
    <a class="pagination-item" href="/project/5">
      <i class="fa fa-arrow-circle-o-left"></i> 
      <span class="pagination-text">older posts</span>
    </a>
  

  <!-- <a class="pagination-item" href="#">archive</a> -->

  
    <a class="pagination-item" href="/project/3">
      <span class="pagination-text">newer posts</span> 
      <i class="fa fa-arrow-circle-o-right"></i>
    </a>
  
</div>

      </main>

      <footer class="footer">
        <small>
            <span class="copyright"><i class="fa fa-copyright"></i> <time datetime="2021-09-03T20:29:35+01:00">2021</time> Weronika Żak</span> &middot;
            <span>Powered by <a href="http://jekyllrb.com/">Jekyll</a></span>
        </small>
        <div class="ftr-links">
          <a href="https://github.com/tableClothed"><i class="fa fa-github-alt"></i></a>
          <!-- <a href="#"><i class="fa fa-twitter"></i></a> -->
        </div>
      </footer>
    </div>

  </body>
</html>
